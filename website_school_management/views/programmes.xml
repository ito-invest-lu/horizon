<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                       PROGRAMMES                           // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="programmes">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Programmes</t>
            <div class="container">
                <t t-if="len(program_list) == 0">
                    <t t-call="website_school_management.programmes_vide"/>
                </t>
                <t t-else="1">
                    <t t-call="website_school_management.programmes_liste"/>
                </t>
            </div>
        </t>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                     LISTE PROGRAMMES                       // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programmes_liste">
        <h1 t-esc="title"/>
        <div class="oe_structure" />
        <t t-call="website_school_management.programmes_breadcrumb"/>
        <br/>
        <div class="my-2">
        <t t-foreach="options" t-as="option">
            <a class="btn btn-primary my-1" t-att-href="option['uri']"><t t-esc="option['name']" /></a>
        </t>
        </div>
        <t t-if="not program_list">
            <p t-esc="'Aucun résultat pour votre recherche.'"/>
        </t>
        <t t-else="1"> 
            <div class="row">
                <t t-set="d" t-value="False"/>
                <t t-set="c" t-value="False"/>
                <t t-foreach="program_list" t-as="program">
                    <div class="col-12">
                        <t t-if="d != program.domain_name">
                            <h3><t t-esc="program.domain_name" /></h3>
                            <t t-set="d" t-value="program.domain_name"/>
                            <t t-set="c" t-value="False"/>
                        </t>
                        <t t-if="c != program.cycle_id">
                            <h4><t t-esc="program.cycle_id.name" /></h4>
                            <t t-set="c" t-value="program.cycle_id"/>
                        </t>
                        <div class="thumbnail oe_school_program">
                            <div class="caption">
                                <a t-att-href="program.program_uri"><t t-esc="program.name" /></a>
                            </div>
                        </div>
                    </div>
                </t>
            </div> 
        </t> 
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                PAS DE RESULTATS (PROGRAMMES)               // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programmes_vide">
        <h1 t-esc="title"/>
        <div class="oe_structure">
            <p>Aucun programme de cours correspondant.</p>
            <hr/>
            <p style="text-align: center;"><a href="/programmes">Retour à la recherche</a></p>
        </div>        
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                     FICHE PROGRAMME                        // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programme_fiche">
    <t t-call="website.layout">
        <t t-set="title" t-value="program.name" />
        <div class="container">
            <h2>Détails du programme</h2>
            <div>  
                <a class="btn btn-default" t-att-href="'/impression_programme/%s' % program.id" target="new">
                    <i class="fa fa-print fa-2x" title="Imprimer" aria-hidden="true"></i>
                    <span class="sr-only">Imprimer</span>
                </a> 
            </div>
            <hr/>
            <t t-call="website_school_management.programmes_breadcrumb"/>
            <hr/>
            <t t-call="website_school_management.programme_details_contenu"/>
        </div>
    </t>
    </template>

    <!-- TODO à adapter -->
   <template id="programme_details_contenu" name="Program Details Content">
        <div>
            <h4>PROFIL D’ENSEIGNEMENT</h4>
            <h4><t t-esc="program.name" /></h4>
        </div>
        <hr/>
        <div>
            <div>
                <p>DOMAINE</p>
                <p><t t-esc="program.domain_name" /></p>
            </div>
            <div>
                <p>CYCLE</p>
                <p><t t-esc="program.cycle_id.name" /></p>
            </div>
            <div>
                <p>SECTION</p>
                <p><t t-esc="program.speciality_id.section_id.name" /></p>
            </div>
            <div>
                <p>ORIENTATION</p>
                <p><t t-esc="program.speciality_id.track_id.name" /></p>
            </div>
            <div>
                <p>SPÉCIALITÉ</p>
                <p><t t-esc="program.speciality_id.name" /></p>
            </div>
        </div>
        <hr/>
        <div t-if="program.description">
            <h4>VADE MECUM</h4>
            <p><t t-esc="program.description"/></p>
            <hr/>
        </div>
        <div>
            <h4>PROGRAMME DES COURS</h4>
            <div t-foreach="program.bloc_ids" t-as="bloc">
                <t t-call="website_school_management.school_bloc_contenu"/>
            </div>
        </div>
        <hr/>
    </template>

    <!-- TODO à adapter -->
    <template id="school_bloc_contenu" name="Bloc">
        <div>
            <h5>Grille du bloc - <t t-esc="bloc.name"/></h5>
            <div>
                <div>
                    <t t-set="group" t-value=""/>
                    <!-- Groupes de cours -->
                    <t t-foreach="bloc.course_group_ids.sorted(key=lambda r: r.cg_grouping_sequence)" t-as="course_group">
                        <!-- Groupe du groupe de cours -->
                        <t t-if="course_group.cg_grouping.id != group">
                            <hr/>
                            <h6><t t-esc="course_group.cg_grouping.name"/></h6>
                            <hr/>
                        </t>
                        <ul>
                            <!-- Groupe de cours -->
                            <t t-set="group" t-value="course_group.cg_grouping.id"/>
                            <li>Code : <t t-esc="course_group.ue_id"/></li>
                            <li> Unités d’enseignement : <a t-esc="course_group.title" t-att-href="'/groupe_de_cours/%s' % slug(course_group)" target="_self"/></li>
                            <li>Professeur : <t t-esc="course_group.responsible_id.name"/></li>
                            <li>Heures : <t t-esc="course_group.total_hours"/></li>
                            <li>ECTS : <t t-esc="course_group.total_credits"/></li>
                            <li>
                                Pré-requis : 
                                <t t-if="course_group.pre_requisit_ids">
                                    <span t-esc="', '.join(map( lambda x: str(x.preriquisit_id.uid), course_group.pre_requisit_ids))"/>
                                </t>
                                <t t-else="">
                                    <span>/</span>
                                </t>
                            </li>
                            <li>
                                Co-requis : 
                                <t t-if="course_group.co_requisit_ids">
                                    <span t-esc="', '.join(map( lambda x: str(x.coriquisit_id.uid), course_group.co_requisit_ids))"/>
                                </t>
                                <t t-else="">
                                    <span>/</span>
                                </t>
                            </li>
                            <!-- Cours -->
                            <li> Cours: 
                                <t t-foreach="course_group.course_ids" t-as="course">
                                    <ul>
                                        <li>Nom : <t t-esc="course.title"/></li>
                                        <li>ECTS : <t t-esc="course.credits"/></li>
                                        <li>Pondération : <t t-esc="course.weight"/></li>
                                        <li>Quadri : <t t-esc="course.quadri"/></li>
                                    </ul>
                                    <br/>
                                </t>
                            </li>
                            <hr/>
                        </ul>
                    </t>
                    <!-- Total -->
                    <p>Total :</p>
                    <ul>
                        <li>Heures : <t t-esc="bloc.total_hours"/></li>
                        <li>ECTS : <t t-esc="bloc.total_credits"/></li>
                    </ul>
                    <hr/>  
                </div>
            </div>    
        </div>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                   FICHE GROUPE DE COURS                    // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="groupe_de_cours_fiche">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Groupe de cours</t>
            <div class="container">
                <t t-set="desc" t-value="course_group"/>
                <section>
                    <div class="row mt64 mb64">
                        <h1>
                            Course Group Description
                        </h1>
                        <h1>
                            <span t-field="course_group.title"/>
                        </h1>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">Course Group Informations</div>
                        <div class="panel-body">
                            <table class="table table-striped">
                                <colgroup>
                                    <col style="width:250px"/>
                                    <col style="width:100%"/>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <td>Code</td>
                                    <td><span t-field="course_group.uid"/></td>
                                </tr>
                                <tr>
                                    <td>Cycle</td>
                                    <td><span t-field="course_group.cycle_id.grade"/></td>
                                </tr>
                                <tr>
                                    <td>Teacher</td>
                                    <td><span t-field="course_group.responsible_id"/></td>
                                </tr>
                                <tr>
                                    <td>Period</td>
                                    <td><span t-field="course_group.period"/></td>
                                </tr>
                                <tr>
                                    <td>Credits</td>
                                    <td><span t-field="course_group.total_credits"/></td>
                                </tr>
                                <tr>
                                    <td>Hours</td>
                                    <td><span t-field="course_group.total_hours"/></td>
                                </tr>
                                <tr>
                                    <td>Mandatory</td>
                                    <td><t t-if="course_group.mandatory"><input type="checkbox" value="" checked=""/></t><t t-if="not(course_group.mandatory)"><input type="checkbox" value=""/></t></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="panel panel-default">
                        <div class="panel-heading">Course Informations</div>
                        <div class="panel-body">
                            <table class="table table-striped">
                                <colgroup>
                                    <col style="width:600px"/>
                                    <col style="width:100px"/>
                                    <col style="width:100px"/>
                                    <col style="width:100px"/>
                                </colgroup>
                                <tr>
                                <td>Title</td>
                                <td>Hours</td>
                                <td>Credits</td>
                                <td>Weight</td>
                                </tr>
                                <tr t-foreach="course_group.course_ids" t-as="course">
                                <td>
                                    <a t-esc="course.title" t-att-href="'/cours/%s' % slug(course)" target="new" style="cursor: pointer;"/>
                                    <br/><t t-foreach="course.teacher_ids" t-as="teacher"><i style="color:grey;" t-esc="teacher.name"/><t t-if="teacher_index &lt; (teacher_size - 1)">,</t></t>
                                </td>
                                <td class="text-center"><t t-esc="course.hours"/></td>
                                <td class="text-center"><t t-esc="course.credits"/></td>
                                <td class="text-center"><t t-esc="course.weight"/></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </section>
                <t t-foreach="course_group.course_ids" t-as="course">
                    <t t-set="desc" t-value="course.documentation_id"/>
                    <t t-if="desc">
                    <p style="page-break-after:always;">   </p>
                    <t t-call="website_school_management.cours_fiche_details"/>
                    </t>
                    <t t-else="">
                    <p style="page-break-after:always;">   </p>
                    <section>
                        <div class="row mt64 mb64">
                            <h1>
                                <t t-if="desc.state == 'draft'">Draft </t>Course Description
                            </h1>
                            <h1>
                                <span t-field="course.name"/>
                            </h1>
                            <h2>
                                Pas de descriptif disponible.
                            </h2>
                        </div>
                    </section>
                    </t>
                </t>
            </div>
        </t>
    </template>

    <!-- TODO à adapter -->
    <template id="groupe_de_cours_fiche_vide">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Groupe de cours</t>
            <div class="container">
                <h1>Pas de description</h1>      
                <p>Veuillez contacter le secrétariat ou votre professeur pour obtenir plus d'informations sur cette activité.</p>
            </div>
        </t>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                        FICHE COURS                         // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="cours_fiche">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Cours</t>
            <div class="container">
                <t t-foreach="course_docs" t-as="course_doc">
                    <t t-set="desc" t-value="course_doc"/>
                    <t t-call="website_school_management.cours_fiche_details" />
                </t>
            </div>
        </t>      
    </template>

  <template id="cours_fiche_details">
      <section>
        <div class="row mt64 mb64">
            <h1>
                <t t-if="desc.state == 'draft'">Draft </t>Course Description
            </h1>
            <h1>
                <span t-field="desc.name"/>
            </h1>
            <h3 class="oe_fade">
                by <span t-field="desc.author_id"/>
            </h3>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Course Informations</div>
            <div class="panel-body">
                <table class="table table-striped">
                    <colgroup>
                        <col style="width:250px"/>
                        <col style="width:100%"/>
                    </colgroup>
                    <tbody>
                      <tr>
                        <td>Cycle</td>
                        <td><span t-field="desc.cycle_id"/></td>
                      </tr>
                      <tr>
                        <td>Course Group</td>
                        <td><span t-field="desc.course_group_id.ue_id"/> - <span t-field="desc.course_group_id"/></td>
                      </tr>
                      <tr>
                        <td>Level</td>
                        <td><span t-field="desc.level"/></td>
                      </tr>
                      <tr>
                        <td>Credits</td>
                        <td><span t-field="desc.credits"/></td>
                      </tr>
                      <tr>
                        <td>Hours</td>
                        <td><span t-field="desc.hours"/></td>
                      </tr>
                      <tr>
                        <td>Weight</td>
                        <td><span t-field="desc.weight"/></td>
                      </tr>
                      <tr>
                        <td>Mandatory</td>
                        <td><t t-if="desc.mandatory"><input type="checkbox" value="" checked=""/></t><t t-if="not(desc.mandatory)"><input type="checkbox" value=""/></t></td>
                      </tr>
                      <tr>
                        <td>Language</td>
                        <td><span t-field="desc.language"/></td>
                      </tr>
                      <tr>
                        <td>Teachers</td>
                        <td><span t-esc="', '.join(map( lambda x: x.name, desc.staff_ids))"/></td>
                      </tr>
                    </tbody>
                 </table>
            </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Schedule - <span t-field="desc.schedule"/></h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.schedule_text"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Content</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.content"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Method</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.method"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Learning outcomes</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.learning_outcomes"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">References</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.references"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Pre-Co requiered</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.pre_co_requiered"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Evaluation method</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.evaluation_method"/>
          </div>
        </div>
      </section>
    </template>

    <template id="cours_fiche_vide">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Cours</t>
            <div class="container">
                <h1>Pas de description</h1>      
                <p>Veuillez contacter le secrétariat ou votre professeur pour obtenir plus d'informations sur cette activité.</p>
            </div>
        </t>
    </template>
    
    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                         BREADCRUMB                         // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="programmes_breadcrumb">
        <t t-set="count" t-value="1" />
        <t t-foreach="breadcrumb" t-as="breadcrumb_item">
            <t t-if="count &lt; len(breadcrumb)">
                <a t-att-href="breadcrumb_item['uri']"><t t-esc="breadcrumb_item['name']" /></a>
                <t t-if="len(breadcrumb) != 1"><span> &gt; </span></t>
                <t t-set="count" t-value="count + 1" />
            </t>
            <t t-else="1">
                <span><t t-esc="breadcrumb_item['name']" /></span>
            </t>
        </t>
    </template>
  
</odoo>