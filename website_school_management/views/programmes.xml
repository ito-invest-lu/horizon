<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                       PROGRAMMES                           // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="programmes">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Programmes</t>
            <div class="container">
                <t t-if="len(program_list) == 0">
                    <t t-call="website_school_management.programmes_vide"/>
                </t>
                <t t-else="1">
                    <t t-call="website_school_management.programmes_liste"/>
                </t>
            </div>
        </t>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                     LISTE PROGRAMMES                       // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programmes_liste">
        <h1 t-esc="'Programmes'"/>
        <div class="oe_structure" />
        <t t-call="website_school_management.programmes_breadcrumb"/>
        <br/>
        <div class="my-2">
        <t t-foreach="options" t-as="option">
            <a class="btn btn-primary my-1" t-att-href="option['uri']"><t t-esc="option['name']" /></a>
        </t>
        </div>
        <t t-if="not program_list">
            <p t-esc="'Aucun résultat pour votre recherche.'"/>
        </t>
        <t t-else="1"> 
            <div class="row">
                <t t-set="d" t-value="False"/>
                <t t-set="c" t-value="False"/>
                <t t-foreach="program_list" t-as="program_item">
                    <div class="col-12">
                        <t t-set="program" t-value="program_item['program']"/>
                        <t t-if="d != program.domain_name"> 
                            <h3><t t-esc="program.domain_name" /></h3>
                            <t t-set="d" t-value="program.domain_name"/>
                            <t t-set="c" t-value="False"/>
                        </t>
                        <t t-if="c != program.cycle_id">
                            <h4><t t-esc="program.cycle_id.name" /></h4>
                            <t t-set="c" t-value="program.cycle_id"/>
                        </t>
                        <div class="thumbnail oe_school_program">
                            <div class="caption">
                                <a t-att-href="program.program_uri"><t t-esc="program.name" /></a>
                            </div>
                        </div>
                    </div>
                </t>
            </div> 
        </t> 
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                PAS DE RESULTATS (PROGRAMMES)               // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programmes_vide">
        <h1 t-esc="'Programmes'"/>
        <p t-esc="message" />
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                     FICHE PROGRAMME                        // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="programme_fiche">
    <t t-call="website.layout">
        <t t-set="title">Détails du programme</t>
        <div class="container">
            <div class="oe_structure"/>
            <article class="container oe_school_program_details">
                <section class="row text-center">
                    <div class="col-md-10"><h2>Détails du programme</h2></div>
                    <div class="col-md-2">
                        <span class="row">
                            <a class="btn btn-default" t-att-href="'/impression_programme/%s' % program.id" target="new">
                            <i class="fa fa-print fa-2x" title="Settings" aria-hidden="true"></i>
                            <span class="sr-only">Print</span>
                            </a>
                        </span>
                    </div>
                    <div class="col-12">
                        <t t-call="website_school_management.programmes_breadcrumb"/>
                    </div>
                </section>
                <hr/>
                <t t-call="website_school_management.programme_details_contenu"/>
            </article>
        </div>
    </t>
    </template>

    <!-- TODO à adapter -->
   <template id="programme_details_contenu" name="Program Details Content">
        <section class="row">
            <div class="col-md-4"><h4>PROFIL D’ENSEIGNEMENT</h4></div>
            <div class="col-md-6"><h4><t t-esc="program.name" /></h4></div>
            <!--<div class="col-md-2"><h4><t t-esc="program.year_id.name" /></h4></div>-->
        </section>
        <hr/>
        <section>
            <div class="row">
                <div class="col-md-2"><font color="grey">DOMAINE</font></div>
                <div class="col-md-10"><t t-esc="program.domain_name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">CYCLE</font></div>
                <div class="col-md-10"><t t-esc="program.cycle_id.name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">SECTION</font></div>
                <div class="col-md-10"><t t-esc="program.speciality_id.section_id.name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">ORIENTATION</font></div>
                <div class="col-md-10"><t t-esc="program.speciality_id.track_id.name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">SPÉCIALITÉ</font></div>
                <div class="col-md-10"><t t-esc="program.speciality_id.name" /></div>
            </div>
        </section>
        <hr/>
        <section class="row" t-if="program.description">
            <div class="col-md-12"><h4>VADE MECUM</h4></div>
            <div class="col-md-12" style='white-space: pre-wrap;'><t t-esc="program.description"/></div>
            <hr/>
        </section>
        <!--<section class="row" t-if="program.competency_ids">
            <div class="col-md-12"><h4>RÉFÉRENTIELS DE COMPÉTENCES ATTENDUES</h4></div>
            <div class="col-md-12">
                <table class="table table-striped">
                    <caption>A la fin du cycle, l’étudiant doit être capable :</caption>
                    <col width='50px'/>
                    <col width="100%"/><t t-set="comp_cnt" t-value="0"/>
                    <tr t-foreach="program.competency_ids" t-as="comp"><t t-set="comp_cnt" t-value="comp_cnt+1"/>
                        <th scope="row"><bold><t t-esc="comp_cnt"/></bold></th><td><t t-esc="comp.description"/></td>
                    </tr>
                </table>
            </div>
            <hr/>
        </section>-->
        <section class="row">
            <div class="col-md-12">
                <h4>PROGRAMME DES COURS</h4>
            </div>
        </section>
        <section class="row" t-foreach="program.bloc_ids" t-as="bloc">
            <t t-call="website_school_management.school_bloc_contenu"/>
        </section>
        <hr/>
    </template>

    <!-- TODO à adapter -->
    <template id="school_bloc_contenu" name="Bloc">
        <div class="col-md-12">
            <table class="table table-condensed oe_school_program_table">
                <caption style="font-size: 100%;">Grille du bloc - <t t-esc="bloc.name"/></caption>
                <colgroup>
                    <col style="width:75px"/>
                    <col style="width:400px"/>
                    <col style="width:60px"/>
                    <col style="width:60px"/>
                    <col style="width:60px"/>
                    <col style="width:150px"/>
                    <col style="width:150px"/>
                </colgroup>
                <thead>
                    <tr>
                        <th>UID</th> 
                        <th>Unités d’enseignement</th> 
                        <th class="text-center">Heures</th> 
                        <th class="text-center">ECTS</th>
                        <th class="text-center">Pond</th>
                        <th>Pré-requis</th>
                        <th>Co-requis</th>
                    </tr> 
                </thead>
                <tbody>
                    <t t-set="group" t-value=""/>
                    <t t-foreach="bloc.course_group_ids.sorted(key=lambda r: r.cg_grouping_sequence)" t-as="course_group">
                    <t t-if="course_group.cg_grouping.id != group">
                        <tr>
                            <td colspan="7"><t t-esc="course_group.cg_grouping.name"/></td>
                        </tr>
                    </t>
                    <t t-set="group" t-value="course_group.cg_grouping.id"/>
                    <tr class="oe_school_course_group" style="font-weight: 600;">
                        <td style="font-size: x-small;"><t t-esc="course_group.ue_id"/></td>
                        <td><a t-esc="course_group.title" t-att-href="'/groupe_de_cours/%s' % slug(course_group)" target="_self" style="cursor: pointer;"/><br/><i style="color:grey;"><t t-esc="course_group.responsible_id.name"/></i></td>
                        <td class="text-center"><t t-esc="course_group.total_hours"/></td>
                        <td class="text-center"><t t-esc="course_group.total_credits"/></td>
                        <td></td>
                        <td style="font-size: x-small;"><t t-if="course_group.pre_requisit_ids"><span t-esc="', '.join(map( lambda x: str(x.preriquisit_id.uid), course_group.pre_requisit_ids))"/></t></td>
                        <td style="font-size: x-small;"><t t-if="course_group.co_requisit_ids"><span t-esc="', '.join(map( lambda x: str(x.coriquisit_id.uid), course_group.co_requisit_ids))"/></t></td>
                    </tr>
                    <tr t-foreach="course_group.course_ids" t-as="course">
                        <td></td>
                        <td><t t-esc="course.title"/></td>
                        <td class="text-center"><t t-esc="course.hours"/></td>
                        <td class="text-center"><t t-esc="course.credits"/></td>
                        <td class="text-center"><t t-esc="course.weight"/></td>
                        <!--<td></td>-->
                        <td></td>
                        <td></td>
                    </tr>
                    </t>
                    <tr style="font-weight: 800;">
                        <td></td>
                        <td class="text-right">Total :</td>
                        <td class="text-center"><t t-esc="bloc.total_hours"/></td>
                        <td class="text-center"><t t-esc="bloc.total_credits"/></td>
                        <td></td>
                        <!--<td></td>-->
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                   FICHE GROUPE DE COURS                    // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <!-- TODO à adapter -->
    <template id="groupe_de_cours_fiche">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Groupe de cours</t>
            <div class="container">
                <t t-set="desc" t-value="course_group"/>
                <section>
                    <div class="row mt64 mb64">
                        <h1>
                            Course Group Description
                        </h1>
                        <h1>
                            <span t-field="course_group.title"/>
                        </h1>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">Course Group Informations</div>
                        <div class="panel-body">
                            <table class="table table-striped">
                                <colgroup>
                                    <col style="width:250px"/>
                                    <col style="width:100%"/>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <td>Code</td>
                                    <td><span t-field="course_group.uid"/></td>
                                </tr>
                                <tr>
                                    <td>Cycle</td>
                                    <td><span t-field="course_group.cycle_id.grade"/></td>
                                </tr>
                                <tr>
                                    <td>Teacher</td>
                                    <td><span t-field="course_group.responsible_id"/></td>
                                </tr>
                                <tr>
                                    <td>Period</td>
                                    <td><span t-field="course_group.period"/></td>
                                </tr>
                                <tr>
                                    <td>Credits</td>
                                    <td><span t-field="course_group.total_credits"/></td>
                                </tr>
                                <tr>
                                    <td>Hours</td>
                                    <td><span t-field="course_group.total_hours"/></td>
                                </tr>
                                <tr>
                                    <td>Mandatory</td>
                                    <td><t t-if="course_group.mandatory"><input type="checkbox" value="" checked=""/></t><t t-if="not(course_group.mandatory)"><input type="checkbox" value=""/></t></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="panel panel-default">
                        <div class="panel-heading">Course Informations</div>
                        <div class="panel-body">
                            <table class="table table-striped">
                                <colgroup>
                                    <col style="width:600px"/>
                                    <col style="width:100px"/>
                                    <col style="width:100px"/>
                                    <col style="width:100px"/>
                                </colgroup>
                                <tr>
                                <td>Title</td>
                                <td>Hours</td>
                                <td>Credits</td>
                                <td>Weight</td>
                                </tr>
                                <tr t-foreach="course_group.course_ids" t-as="course">
                                <td>
                                    <a t-esc="course.title" t-att-href="'/cours/%s' % slug(course)" target="new" style="cursor: pointer;"/>
                                    <br/><t t-foreach="course.teacher_ids" t-as="teacher"><i style="color:grey;" t-esc="teacher.name"/><t t-if="teacher_index &lt; (teacher_size - 1)">,</t></t>
                                </td>
                                <td class="text-center"><t t-esc="course.hours"/></td>
                                <td class="text-center"><t t-esc="course.credits"/></td>
                                <td class="text-center"><t t-esc="course.weight"/></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </section>
                <t t-foreach="course_group.course_ids" t-as="course">
                    <t t-set="desc" t-value="course.documentation_id"/>
                    <t t-if="desc">
                    <p style="page-break-after:always;">   </p>
                    <t t-call="website_school_management.cours_fiche_details"/>
                    </t>
                    <t t-else="">
                    <p style="page-break-after:always;">   </p>
                    <section>
                        <div class="row mt64 mb64">
                            <h1>
                                <t t-if="desc.state == 'draft'">Draft </t>Course Description
                            </h1>
                            <h1>
                                <span t-field="course.name"/>
                            </h1>
                            <h2>
                                Pas de descriptif disponible.
                            </h2>
                        </div>
                    </section>
                    </t>
                </t>
            </div>
        </t>
    </template>

    <!-- TODO à adapter -->
    <template id="groupe_de_cours_fiche_vide">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Groupe de cours</t>
            <div class="container">
                <h1>Pas de description</h1>      
                <p>Veuillez contacter le secrétariat ou votre professeur pour obtenir plus d'informations sur cette activité.</p>
            </div>
        </t>
    </template>

    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                        FICHE COURS                         // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="cours_fiche">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Cours</t>
            <div class="container">
                <t t-foreach="course_docs" t-as="course_doc">
                    <t t-set="desc" t-value="course_doc"/>
                    <t t-call="website_school_management.cours_fiche_details" />
                </t>
            </div>
        </t>      
    </template>

  <template id="cours_fiche_details">
      <section>
        <div class="row mt64 mb64">
            <h1>
                <t t-if="desc.state == 'draft'">Draft </t>Course Description
            </h1>
            <h1>
                <span t-field="desc.name"/>
            </h1>
            <h3 class="oe_fade">
                by <span t-field="desc.author_id"/>
            </h3>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Course Informations</div>
            <div class="panel-body">
                <table class="table table-striped">
                    <colgroup>
                        <col style="width:250px"/>
                        <col style="width:100%"/>
                    </colgroup>
                    <tbody>
                      <tr>
                        <td>Cycle</td>
                        <td><span t-field="desc.cycle_id"/></td>
                      </tr>
                      <tr>
                        <td>Course Group</td>
                        <td><span t-field="desc.course_group_id.ue_id"/> - <span t-field="desc.course_group_id"/></td>
                      </tr>
                      <tr>
                        <td>Level</td>
                        <td><span t-field="desc.level"/></td>
                      </tr>
                      <tr>
                        <td>Credits</td>
                        <td><span t-field="desc.credits"/></td>
                      </tr>
                      <tr>
                        <td>Hours</td>
                        <td><span t-field="desc.hours"/></td>
                      </tr>
                      <tr>
                        <td>Weight</td>
                        <td><span t-field="desc.weight"/></td>
                      </tr>
                      <tr>
                        <td>Mandatory</td>
                        <td><t t-if="desc.mandatory"><input type="checkbox" value="" checked=""/></t><t t-if="not(desc.mandatory)"><input type="checkbox" value=""/></t></td>
                      </tr>
                      <tr>
                        <td>Language</td>
                        <td><span t-field="desc.language"/></td>
                      </tr>
                      <tr>
                        <td>Teachers</td>
                        <td><span t-esc="', '.join(map( lambda x: x.name, desc.staff_ids))"/></td>
                      </tr>
                    </tbody>
                 </table>
            </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Schedule - <span t-field="desc.schedule"/></h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.schedule_text"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Content</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.content"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Method</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.method"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Learning outcomes</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.learning_outcomes"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">References</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.references"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Pre-Co requiered</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.pre_co_requiered"/>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Evaluation method</h3>
          </div>
          <div class="panel-body">
            <span style="padding:5px;" t-raw="desc.evaluation_method"/>
          </div>
        </div>
      </section>
    </template>

    <template id="cours_fiche_vide">
        <t t-call="website.layout"> <!-- Affiche le layout du site web -->
            <t t-set="title">Cours</t>
            <div class="container">
                <h1>Pas de description</h1>      
                <p>Veuillez contacter le secrétariat ou votre professeur pour obtenir plus d'informations sur cette activité.</p>
            </div>
        </t>
    </template>
    
    <!-- //////////////////////////////////////////////////////////////// -->
    <!-- //                         BREADCRUMB                         // -->
    <!-- //////////////////////////////////////////////////////////////// -->

    <template id="programmes_breadcrumb">
        <t t-set="count" t-value="1" />
        <t t-foreach="breadcrumb" t-as="breadcrumb_item">
            <t t-if="count &lt; len(breadcrumb)">
                <a t-att-href="breadcrumb_item['uri']"><t t-esc="breadcrumb_item['name']" /></a>
                <t t-if="len(breadcrumb) != 1"><span> &gt; </span></t>
                <t t-set="count" t-value="count + 1" />
            </t>
            <t t-else="1">
                <span><t t-esc="breadcrumb_item['name']" /></span>
            </t>
        </t>
    </template>
  
</odoo>